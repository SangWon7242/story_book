<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <!-- user-scalable=no 제거: 시각 장애 사용자의 핀치 줌 허용 (WCAG 1.4.4) -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>비프의 푸른 바다 모험입니다.</title>
    <meta
      name="description"
      content="화성에서 온 로봇 비프의 신비로운 지구 바다 탐험 동화. 사이버펑크 스타일의 인터랙티브 동화책."
    />
    <!-- PWA manifest (선택적으로 추가 가능) -->
    <meta name="theme-color" content="#1b1b2f" />

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css" />

    <!-- StPageFlip Library -->
    <script src="https://cdn.jsdelivr.net/npm/page-flip@2.0.7/dist/js/page-flip.browser.js"></script>
  </head>
  <body>
    <div class="app-container">
      <!-- 읽기 진행률 바 (상단 고정) -->
      <div class="reading-progress-bar">
        <div id="reading-progress-fill" class="reading-progress-fill"></div>
      </div>

      <!-- Top Bar -->
      <div class="top-bar">
        <div class="top-bar-left">
          <button
            id="btn-library"
            class="toolbar-btn"
            aria-label="동화 목록"
            title="동화 목록"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
              />
            </svg>
            목록
          </button>
          <div class="top-bar-title">
            <h1>📖 비프의 푸른 바다 모험</h1>
            <span class="subtitle"
              >화성에서 온 로봇, 비프의 신비로운 지구 탐험기</span
            >
          </div>
        </div>
        <div class="top-bar-right">
          <div class="top-bar-meta">
            <div class="meta-item">
              <span class="meta-label">테마</span>
              <span class="meta-value">새로운 만남과 우정</span>
            </div>
            <div class="meta-divider"></div>
            <div class="meta-item">
              <span class="meta-label">주인공</span>
              <span class="meta-value">로봇 비프 &amp; 집게</span>
            </div>
            <div class="meta-divider"></div>
            <div class="meta-item">
              <span class="meta-label">스타일</span>
              <span class="meta-value">사이버펑크 동화</span>
            </div>
          </div>
          <!-- Settings Toolbar -->
          <div class="settings-toolbar">
            <div class="font-size-group">
              <button
                class="toolbar-btn font-btn"
                data-size="small"
                aria-label="작은 글자"
                title="작은 글자"
              >
                가
              </button>
              <button
                class="toolbar-btn font-btn active"
                data-size="medium"
                aria-label="보통 글자"
                title="보통 글자"
              >
                가
              </button>
              <button
                class="toolbar-btn font-btn"
                data-size="large"
                aria-label="큰 글자"
                title="큰 글자"
              >
                가
              </button>
            </div>
            <button
              id="btn-theme-toggle"
              class="toolbar-btn"
              aria-label="다크모드 전환"
              title="다크모드 전환"
            >
              <svg
                class="icon-sun"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="5" />
                <path
                  stroke-linecap="round"
                  d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"
                />
              </svg>
              <svg
                class="icon-moon"
                style="display: none"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"
                />
              </svg>
            </button>
            <button
              id="btn-sfx-toggle"
              class="toolbar-btn"
              aria-label="효과음 전환"
              title="효과음 ON/OFF"
            >
              <svg
                class="icon-sfx-on"
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"
                />
              </svg>
              <svg
                class="icon-sfx-off"
                style="display: none"
                xmlns="http://www.w3.org/2000/svg"
                fill="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"
                />
              </svg>
            </button>
            <!-- 전체화면 버튼 -->
            <button
              id="btn-fullscreen"
              class="toolbar-btn"
              aria-label="전체화면"
              title="전체화면"
            >
              <svg
                class="icon-expand"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"
                />
              </svg>
              <svg
                class="icon-collapse"
                style="display: none"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Book Area -->
      <div class="book-area">
        <div class="book-stage">
          <div id="book" class="book-container">
            <!-- Pages will be dynamically generated by JS -->
          </div>
        </div>
      </div>

      <!-- Bottom Navigation -->
      <nav class="bottom-nav">
        <button
          id="btn-prev"
          class="nav-btn nav-btn-prev"
          aria-label="이전 페이지"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15.75 19.5L8.25 12l7.5-7.5"
            />
          </svg>
          이전
        </button>
        <button
          id="btn-autoplay"
          class="nav-btn nav-btn-auto"
          aria-label="자동 넘김"
          title="자동 넘김"
        >
          <svg
            class="icon-auto-play"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path d="M8 5v14l11-7z" />
          </svg>
          <svg
            class="icon-auto-stop"
            style="display: none"
            xmlns="http://www.w3.org/2000/svg"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path d="M6 6h12v12H6z" />
          </svg>
          <span class="auto-btn-label">자동넘김</span>
        </button>
        <!-- 자동넘김 속도 버튼 -->
        <button
          id="btn-autoplay-speed"
          class="nav-btn nav-btn-speed"
          aria-label="자동넘김 속도"
          title="속도 변경 (보통/빠름/느림)"
        >
          보통
        </button>
        <span id="page-indicator" class="page-indicator">표지</span>
        <button
          id="btn-next"
          class="nav-btn nav-btn-next"
          aria-label="다음 페이지"
        >
          다음
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M8.25 4.5l7.5 7.5-7.5 7.5"
            />
          </svg>
        </button>
        <button
          id="btn-restart"
          class="nav-btn nav-btn-restart"
          aria-label="처음으로"
          title="처음으로"
          style="display: none"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2.5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"
            />
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 3v5h5" />
          </svg>
          처음으로
        </button>
      </nav>
    </div>

    <!-- Resume Toast -->
    <div id="resume-toast" class="resume-toast" style="display: none">
      <span>이전에 읽던 곳이 있어요!</span>
      <button id="resume-toast-btn" class="resume-toast-btn">
        이어서 읽기
      </button>
      <button
        id="resume-toast-close"
        class="resume-toast-close"
        aria-label="닫기"
      >
        &times;
      </button>
    </div>

    <!-- Library Screen -->
    <div id="library-screen" class="library-screen" style="display: none">
      <div class="library-header">
        <h2>동화 라이브러리</h2>
        <p>읽고 싶은 동화를 골라보세요!</p>
      </div>
      <div class="library-grid">
        <div class="library-card library-card-active" data-story="beep">
          <div class="library-card-cover">
            <img src="images/1.png" alt="비프의 푸른 바다 모험 표지" />
          </div>
          <div class="library-card-info">
            <h3>비프의 푸른 바다 모험</h3>
            <span class="library-card-badge">읽기 가능</span>
          </div>
        </div>
        <div class="library-card library-card-coming" data-story="coming1">
          <div class="library-card-cover library-card-placeholder">
            <span>?</span>
          </div>
          <div class="library-card-info">
            <h3>새로운 이야기</h3>
            <span class="library-card-badge coming">준비중</span>
          </div>
        </div>
        <div class="library-card library-card-coming" data-story="coming2">
          <div class="library-card-cover library-card-placeholder">
            <span>?</span>
          </div>
          <div class="library-card-info">
            <h3>새로운 이야기</h3>
            <span class="library-card-badge coming">준비중</span>
          </div>
        </div>
      </div>
      <button id="btn-library-back" class="toolbar-btn library-back-btn">
        동화로 돌아가기
      </button>
    </div>

    <!-- Audio Player (Fixed, above nav) -->
    <div class="audio-player">
      <div id="audio-panel" class="audio-panel">
        <div class="audio-panel-title">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"
            />
          </svg>
          구연동화 오디오
        </div>
        <div class="audio-controls">
          <button
            id="audio-play-btn"
            class="audio-play-btn"
            aria-label="재생/일시정지"
          >
            <svg
              class="icon-play"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path d="M8 5.14v14l11-7-11-7z" />
            </svg>
            <svg
              class="icon-pause"
              style="display: none"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
            </svg>
          </button>
          <div class="audio-progress-wrap">
            <div id="audio-progress-bar" class="audio-progress-bar">
              <div id="audio-progress-fill" class="audio-progress-fill"></div>
            </div>
            <div class="audio-time">
              <span id="audio-current-time">0:00</span>
              <span id="audio-duration">0:00</span>
            </div>
          </div>
        </div>
        <div class="audio-volume-wrap">
          <button
            id="audio-volume-btn"
            class="audio-volume-btn"
            aria-label="음량"
          >
            <svg
              class="icon-vol-high"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"
              />
            </svg>
            <svg
              class="icon-vol-low"
              style="display: none"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"
              />
            </svg>
            <svg
              class="icon-vol-mute"
              style="display: none"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
            >
              <path
                d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"
              />
            </svg>
          </button>
          <input
            type="range"
            id="audio-volume"
            class="audio-volume-slider"
            min="0"
            max="1"
            step="0.01"
            value="0.7"
            aria-label="볼륨 조절"
          />
        </div>
      </div>
      <button
        id="audio-toggle"
        class="audio-toggle-btn"
        aria-label="오디오 패널 열기"
      >
        <svg
          class="icon-play"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path
            d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"
          />
        </svg>
        <svg
          class="icon-pause"
          style="display: none"
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          fill="currentColor"
        >
          <path
            d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"
          />
        </svg>
      </button>
    </div>

    <!-- Audio Element -->
    <audio id="story-audio" preload="metadata">
      <source src="audio/story_audio.mp3" type="audio/mpeg" />
    </audio>

    <!-- Main Script -->
    <script src="js/main.js"></script>
  </body>
</html>
